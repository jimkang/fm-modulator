!function(){return function e(t,n,r){function o(a,c){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!c&&u)return u(a,!0);if(i)return i(a,!0);var s=new Error("Cannot find module '"+a+"'");throw s.code="MODULE_NOT_FOUND",s}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){return o(t[a][1][e]||e)},l,l.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}}()({1:[function(e,t,n){"use strict";var r=e("./index"),o=e("handle-error-web"),i=e("oknok"),a=e("audio-context-singleton"),c=e("./recorder"),u=a().getCurrentContext;document.getElementById("start-button").addEventListener("click",function(){console.log("started"),u(i({ok:function(e){var t=e.createOscillator();t.type=p.value,t.frequency.value=d.value,r({ctx:e,index:+l.value,modFreq:+f.value,carrierOsc:t,signalBuffer:s})({delaySeconds:0,durationSeconds:+m.value})},nok:o}))});var s,l=document.getElementById("index-field"),f=document.getElementById("mod-freq-field"),d=document.getElementById("carrier-field"),p=document.getElementById("wave-type-select"),m=document.getElementById("duration-field");c({onError:o,onRecorded:function(e){s=e}})},{"./index":2,"./recorder":11,"audio-context-singleton":3,"handle-error-web":7,oknok:9}],2:[function(e,t,n){"use strict";t.exports=function(e){var t,n=e.index,r=e.signalBuffer,o=e.modFreq,i=e.carrierOsc,a=e.ctx,c=n*o;r?t=new AudioBufferSourceNode(a,{buffer:r,loop:!0}):(t=a.createOscillator()).frequency.value=o;var u=a.createGain();return u.gain.value=c,t.connect(u),u.connect(i.frequency),i.connect(a.destination),function(e){var n=e.delaySeconds,r=e.durationSeconds,o=a.currentTime+n,c=o+r;t.start(o),t.stop(c),i.start(o),i.stop(c)}}},{}],3:[function(e,t,n){var r=e("call-next-tick");t.exports=function(){var e;return{getCurrentContext:function(n){e?r(n,null,e):t(n)},getNewContext:t};function t(t,n){var r,o;function i(){var t;r&&r.sampleRate&&(t={sampleRate:r.sampleRate}),e="function"==typeof AudioContext?new AudioContext(t):new webkitAudioContext(t),o(null,e)}"function"==typeof t?o=t:"function"==typeof n&&(o=n,"object"==typeof t&&(r=t)),e?e.close().then(i):i()}}},{"call-next-tick":5}],4:[function(e,t,n){function r(e,t,n){for(var r=0;r<n.length;r++)e.setUint8(t+r,n.charCodeAt(r))}t.exports=function(e,t){t=t||{};var n,o=e.numberOfChannels,i=e.sampleRate,a=t.float32?3:1,c=3===a?32:16;n=2===o?function(e,t){var n=e.length+t.length,r=new Float32Array(n),o=0,i=0;for(;o<n;)r[o++]=e[i],r[o++]=t[i],i++;return r}(e.getChannelData(0),e.getChannelData(1)):e.getChannelData(0);return function(e,t,n,o,i){var a=i/8,c=o*a,u=new ArrayBuffer(44+e.length*a),s=new DataView(u);r(s,0,"RIFF"),s.setUint32(4,36+e.length*a,!0),r(s,8,"WAVE"),r(s,12,"fmt "),s.setUint32(16,16,!0),s.setUint16(20,t,!0),s.setUint16(22,o,!0),s.setUint32(24,n,!0),s.setUint32(28,n*c,!0),s.setUint16(32,c,!0),s.setUint16(34,i,!0),r(s,36,"data"),s.setUint32(40,e.length*a,!0),1===t?function(e,t,n){for(var r=0;r<n.length;r++,t+=2){var o=Math.max(-1,Math.min(1,n[r]));e.setInt16(t,o<0?32768*o:32767*o,!0)}}(s,44,e):function(e,t,n){for(var r=0;r<n.length;r++,t+=4)e.setFloat32(t,n[r],!0)}(s,44,e);return u}(n,a,i,o,c)}},{}],5:[function(e,t,n){(function(e){t.exports=function(){var t,n,r,o=arguments.length;if(!(o>0))throw new Error("No callback provided to callNextTick.");t=arguments[0],n=new Array(o-1);for(var i=1;i<o;++i)n[i-1]=arguments[i];r=function(e,t){return function(){e.apply(e,t)}}(t,n),e.nextTick(r)}}).call(this,e("_process"))},{_process:10}],6:[function(e,t,n){function r(e){var t=e.length,n=[];if(t>1){n=new Array(t-1);for(var r=1;r<t;++r)n[r-1]=e[r]}return n}t.exports=async function(e){var t=r(arguments);return new Promise(function(n){t.push(function(e){n({error:e,values:r(arguments)})}),e.apply(e,t)})}},{}],7:[function(e,t,n){t.exports=function(e){if(e){console.error(e,e.stack);var t="";e.name&&(t+=e.name+": "),t+=e.message,e.stack&&(t+=" | "+e.stack.toString()),function(e){var t=document.getElementById("status-message");t.textContent=e,t.classList.remove("hidden")}(t)}}},{}],8:[function(e,t,n){var r=e("errorback-promise"),o=e("audio-context-singleton");function i(){var e=Array.prototype.slice.call(arguments,1),t=arguments[0];setTimeout(function(){t.apply(t,e)},0)}t.exports=async function({onRecordingStart:e,onEnded:t,onError:n,addNodes:a,maxSeconds:c=60}){if(navigator.mediaDevices){var u=o(),s=await r(u.getNewContext);if(!s.error){var l=s.values[0];return navigator.mediaDevices.getUserMedia({audio:!0}).then(function(n){var r=new AudioBuffer({length:c*l.sampleRate,numberOfChannels:1,sampleRate:l.sampleRate}),o=0,u=l.createScriptProcessor(4096,1,1);u.onaudioprocess=function(e){var t=new Float32Array(e.inputBuffer.length);e.inputBuffer.copyFromChannel(t,0,0),r.copyToChannel(t,0,o),o+=t.length};let s=l.createMediaStreamSource(n);function f(){var e,n,i,a;t((e=r,n=o,i=new AudioBuffer({length:n,numberOfChannels:1,sampleRate:e.sampleRate}),a=e.getChannelData(0).slice(0,n),i.copyToChannel(a,0,0),i))}s.connect(u),u.connect(l.destination),a&&a({audioCtx:l,micNode:s,recorderNode:u}),i(e,function(){i(f)})}).catch(n),{audioCtx:l}}i(n,s.error)}else i(n,new Error("Recording is not supported in this browser."))}},{"audio-context-singleton":3,"errorback-promise":6}],9:[function(e,t,n){t.exports=function({ok:e,nok:t,log:n=console.log}){return function(r){if(r)n&&(r.stack?n(r,r.stack):n(r)),t&&t(r);else if(e){var o=Array.prototype.slice.call(arguments,1);t&&o.push(t),e.apply(e,o)}}}},{}],10:[function(e,t,n){var r,o,i=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function u(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(e){o=c}}();var s,l=[],f=!1,d=-1;function p(){f&&s&&(f=!1,s.length?l=s.concat(l):d=-1,l.length&&m())}function m(){if(!f){var e=u(p);f=!0;for(var t=l.length;t;){for(s=l,l=[];++d<t;)s&&s[d].run();d=-1,t=l.length}s=null,f=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function v(e,t){this.fun=e,this.array=t}function h(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new v(e,t)),1!==l.length||f||u(m)},v.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],11:[function(e,t,n){"use strict";var r,o=e("mic-to-buffer"),i=e("audiobuffer-to-wav"),a=!1,c=document.getElementById("record-button"),u=document.getElementById("signal-player");t.exports=function(e){var t=e.onRecorded,n=e.onError;function s(e){r=e,c.textContent="Stop recording",a=!0}function l(e){var n=new Blob([i(e)]);u.setAttribute("src",URL.createObjectURL(n)),u.classList.remove("hidden"),t(e)}c.addEventListener("click",function(){a?(a=!1,r()):o({onEnded:l,onError:n,onRecordingStart:s})})}},{"audiobuffer-to-wav":4,"mic-to-buffer":8}]},{},[1]);